id: 'CVE-2021-3156'
author: 'cekout'
name: 'CVE-2021-3156: sudo vulnerability'
description: 'Check if sudo is vulnerable to sudoedit -s heap-based buffer overflow'
cve: 'CVE-2021-3156'
reference: 'https://nvd.nist.gov/vuln/detail/CVE-2021-3156'
cvss: 7.8
severity: 'high'
match_condition: 'or'
tests:
  - command: "sudoedit -s '0123456789\\'"
    parsers:
      - parser_type: 'matcher'
        rule_type: 'word'
        condition: 'or'
        rules:
          - 'memory'
          - 'Error'
          - 'Backtrace'
          - 'malloc'
          - 'invalid pointer'
  - command: 'sudo --version'
    parsers:
      - parser_type: 'extractor'
        rule_type: 'regex'
        rules:
          - 'Sudo version .*\n'
      - parser_type: 'extractor'
        rule_type: 'regex'
        rules:
          - '([01].[012345678].[0-9]+)|(1.9.[01234])|(1.9.5p1)'